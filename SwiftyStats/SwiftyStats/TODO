- make error handling consistent (throw errors or return nan)
